# Story 1.23: Remove legacy-state-helpers (Store-Only State)

## Status
Planned

## Story
As a developer completing state normalization,
I want to remove `legacy-state-helpers.ts` and call the store directly,
so that the reader has a single source of truth with no compatibility glue.

## Acceptance Criteria
1. All usages of `src/reader/state/legacy-state-helpers.ts` are removed.
2. Modules use store getters/actions directly for timing settings and streaming state updates.
3. Updated modules: `src/reader/text.ts`, `src/reader/streaming-text.ts`, `src/reader/streaming-text-processor.ts`.
4. `legacy-state-helpers.ts` has zero references and is deleted.
5. Streaming progress UI continues to function identically.
6. Lint, typecheck, unit, and Playwright tests all pass.

## Tasks / Subtasks
- [ ] Replace helpers with direct store access
  - [ ] `getTimingSettings` → derive from `useReaderStore.getState()`
  - [ ] `start/reset streaming`, `appendWordItems`, `updateStreamingProgress` → store actions
- [ ] Update reader modules
  - [ ] Refactor `src/reader/text.ts` to remove helper imports
  - [ ] Refactor `src/reader/streaming-text.ts` to use store actions only
  - [ ] Refactor `src/reader/streaming-text-processor.ts` for timing settings from store
- [ ] Delete legacy file
  - [ ] Confirm zero references via ripgrep
  - [ ] Delete `src/reader/state/legacy-state-helpers.ts`
- [ ] Tests and quality gates
  - [ ] Add/adjust minimal unit coverage for any new pure mappers
  - [ ] Run `npm run lint`
  - [ ] Run `npm run typecheck`
  - [ ] Run `npm test` and perform manual streaming verification

## Dev Notes
### Architecture Context
Implements Phase C (Store-Only State) from `docs/refactoring/legacy_removal_plan.md`.

### Risks & Mitigations
- Streaming edge cases → Validate long texts, network variability, and resume paths.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-26 | 1.0 | Initial story draft | Team |

