# Story 1.3: New Directory Structure Creation

## Status
Draft

## Story
**As a** developer preparing for architectural refactoring,
**I want** the new directory structure created as defined in the target architecture,
**so that** I have organized locations ready for the refactored components without disrupting current functionality.

## Acceptance Criteria
1. New top-level directories are created within `src/` as specified: `core/`, `reader/playback/`, `reader/state/`, `reader/timing/`, `reader/ui/`
2. Directory structure exists and is ready for future file migrations
3. Application continues to build and function normally (no files moved yet)
4. All existing Playwright tests continue to pass
5. If any code or scaffolding is introduced as part of this story, it must be covered by unit tests; untouched legacy code can remain without additional tests for now

## Tasks / Subtasks
- [ ] Create core services directory structure (AC: 1)
  - [ ] Create `src/core/` directory
  - [ ] Verify directory exists and has proper permissions
- [ ] Create reader module subdirectories (AC: 1)
  - [ ] Create `src/reader/playback/` directory
  - [ ] Create `src/reader/state/` directory
  - [ ] Create `src/reader/timing/` directory
  - [ ] Create `src/reader/ui/` directory
- [ ] Verify application integrity (AC: 3, 4)
  - [ ] Run `npm run build:chrome` to ensure application builds
  - [ ] Run `npm test` to ensure all Playwright tests pass
  - [ ] Verify extension loads properly in browser (manual verification)

## Dev Notes

### Architecture Context
This story implements Phase 0, Step 0.3 of the refactoring plan, creating the physical directory structure that will house the new service-oriented architecture components.

[Source: docs/refactoring/refactoring_plan.md#phase-0-preparation-and-tooling]

### Target Directory Structure
The new directories align with the target architecture's component organization:

```
src/
├── core/                    # Core services (BrowserApiService, StorageService)
├── reader/
│   ├── playback/           # PlaybackService and related components
│   ├── state/              # Zustand store and state management
│   ├── timing/             # TimingService and timing calculations
│   └── ui/                 # Renderer and UI controls
└── [existing directories remain unchanged]
```

[Source: docs/refactoring/new_architecture.md - Target Architecture]

### Technical Requirements
- Directory creation should not affect existing functionality
- No files should be moved during this story - this is purely structural preparation
- Build system should continue to work unchanged
- Existing file imports and references remain functional

### Current Architecture Context
The current monolithic reader structure will be gradually refactored into these new directories in subsequent phases:
- `src/reader/index.ts` → Will coordinate with new modular structure
- `src/reader/state.ts` → Will be replaced by `src/reader/state/` components
- `src/reader/render.ts` → Will be moved to `src/reader/ui/`
- `src/reader/playback.ts` → Will be moved to `src/reader/playback/`

[Source: docs/architecture.md#reader-ui-modular-architecture]

### Testing Standards
- Verify build integrity: `npm run build:chrome`
- Verify test integrity: `npm test`
- No new unit tests are required if this story only creates directories; however, if any scripts, helpers, or scaffolding code are added, they must be covered by unit tests. Do not add tests for untouched legacy code at this stage.

### Linting Strategy
- When introducing new lint or type checks, add existing files to the ignore list so the baseline continues to pass.
- Whenever you modify one of the ignored files, remove it from the ignore list and resolve any violations so that the updated code complies with the stricter rules.
- Remove this story's touched files from the `.eslintignore` baseline created in Story 1.1 before committing.


### Critical Success Criteria
- New directory structure exists and is ready for future migrations
- Zero impact on existing functionality or build process
- Foundation prepared for subsequent refactoring phases

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-25 | 1.0 | Initial story creation | Scrum Master |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

## QA Results
*This section will be populated by the QA agent after implementation review*
